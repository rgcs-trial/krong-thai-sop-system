
> krong-thai-sop-system@0.2.0 dev /Users/rgcs-admin/workspace/krong-thai-sop-system
> NODE_ENV=development next dev

   â–² Next.js 15.4.4
   - Local:        http://localhost:3000
   - Network:      http://10.0.0.95:3000
   - Environments: .env.local

 âœ“ Starting...
 âœ“ Ready in 1323ms
 â—‹ Compiling /middleware ...
 âœ“ Compiled /middleware in 508ms (264 modules)
âœ… Environment configuration validated for development
 â—‹ Compiling /[locale]/login ...
 âœ“ Compiled /[locale]/login in 3s (946 modules)
 GET /en/login 200 in 3674ms
 âœ“ Compiled in 170ms (365 modules)
 GET /en/login?redirect=%2F 200 in 37ms
 â—‹ Compiling /api/auth/location-session/check ...
 âœ“ Compiled /api/auth/location-session/check in 502ms (986 modules)
 âœ“ Compiled /api/auth/login in 140ms (990 modules)
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /api/auth/location-session/check 200 in 1027ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 687ms
 âœ“ Compiled /api/restaurants in 245ms (1058 modules)
 GET /api/restaurants?active=true 200 in 447ms
 GET /api/restaurants?active=true 200 in 102ms
 âœ“ Compiled in 120ms (366 modules)
 âœ“ Compiled in 101ms (366 modules)
 âœ“ Compiled in 120ms (366 modules)
 GET /en/login?redirect=%2F 200 in 231ms
 GET /api/auth/location-session/check 200 in 190ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /th/login 200 in 14ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 409ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:33.593Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /api/auth/location-session/check 200 in 408ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:33.701Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 âœ“ Compiled in 87ms (366 modules)
 GET /en/login?redirect=%2F 200 in 32ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:34.323Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:35.210Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /th/login 200 in 67ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 36ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:35.331Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:35.341Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:35.764Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2F 200 in 28ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:38.241Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:39.044Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 32ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:39.610Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2F 200 in 26ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:40.069Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:40.872Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 27ms
 GET /en/login?redirect=%2Fen%2Fanalytics 200 in 38ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:41.447Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 27ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:41.874Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login 200 in 26ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:42.300Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:42.718Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2F 200 in 25ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:43.199Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:44.010Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 26ms
 âœ“ Compiled in 79ms (366 modules)
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:44.607Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 âœ“ Compiled in 82ms (366 modules)
 GET /en/login?redirect=%2Fen%2Fanalytics 200 in 52ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 14ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 26ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:45.082Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2F 200 in 23ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:45.984Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:46.786Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fnonexistent-page 200 in 27ms
 GET /en/login?redirect=%2Finvalid%2Froute 200 in 26ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:47.351Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:47.756Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2F 200 in 24ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:48.212Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 âœ“ Compiled in 79ms (366 modules)
 GET /en/login?redirect=%2F 200 in 14ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:48.516Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 âœ“ Compiled in 85ms (366 modules)
 âœ“ Compiled in 89ms (366 modules)
 GET /en/login?redirect=%2F 200 in 87ms
 GET /en/login?redirect=%2F 200 in 70ms
 âœ“ Compiled in 85ms (366 modules)
 GET /en/login?redirect=%2F 200 in 14ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:48.787Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:49.029Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 26ms
 GET /th/login?redirect=%2Fth%2Fdashboard 200 in 25ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:49.587Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 30ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:50.016Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:50.430Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2F 200 in 23ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:50.907Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 âœ“ Compiled in 74ms (366 modules)
 âœ“ Compiled in 80ms (366 modules)
 GET /en/login?redirect=%2F 200 in 147ms
 âœ“ Compiled in 107ms (366 modules)
 âœ“ Compiled in 94ms (366 modules)
 GET /en/login?redirect=%2F 200 in 91ms
 GET /en/login?redirect=%2F 200 in 14ms
 GET /en/login?redirect=%2F 200 in 14ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:51.360Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:51.715Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/login"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 24ms
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:52.277Z",
  "type": "rate_limit_exceeded",
  "source": "auth_middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 5,
    "maxAttempts": 5,
    "windowMs": 900000,
    "path": "/api/auth/location-session/check"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
ðŸ”’ Security Event: {
  "timestamp": "2025-07-27T14:31:52.298Z",
  "type": "rate_limit_exceeded",
  "source": "middleware",
  "details": {
    "ip": "::ffff:127.0.0.1",
    "count": 100,
    "maxRequests": 100,
    "windowMs": 900000,
    "path": "/"
  },
  "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.0.0 Safari/537.36",
  "ip": "::ffff:127.0.0.1"
}
 âœ“ Compiled in 90ms (366 modules)
 âœ“ Compiled in 404ms (1139 modules)
 âœ“ Compiled in 85ms (366 modules)
 âœ“ Compiled in 163ms (366 modules)
 âœ“ Compiled in 138ms (366 modules)
 âœ“ Compiled in 97ms (366 modules)
 âœ“ Compiled in 101ms (366 modules)
 âœ“ Compiled in 134ms (366 modules)
 âœ“ Compiled in 158ms (366 modules)
 âœ“ Compiled in 153ms (366 modules)
 âœ“ Compiled in 75ms (366 modules)
 âœ“ Compiled in 174ms (366 modules)
 âœ“ Compiled in 110ms (366 modules)
 âš  Found a change in next.config.ts. Restarting the server to apply the changes...
   â–² Next.js 15.4.4
   - Local:        http://localhost:3000
   - Network:      http://10.0.0.95:3000
   - Environments: .env.local

 âœ“ Starting...
 âœ“ Ready in 1515ms
 â—‹ Compiling /middleware ...
 âœ“ Compiled /middleware in 560ms (263 modules)
âœ… Environment configuration validated for development
 â—‹ Compiling /[locale]/login ...
 âœ“ Compiled /[locale]/login in 5.6s (945 modules)
 GET /en/login?redirect=%2F 200 in 6245ms
 â—‹ Compiling /api/auth/location-session/check ...
 âœ“ Compiled /api/auth/location-session/check in 808ms (999 modules)
 âœ“ Compiled /api/auth/login in 219ms (989 modules)
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 339ms
 GET /en/login?redirect=%2F 200 in 371ms
 GET /api/auth/location-session/check 200 in 1368ms
 GET /api/auth/location-session/check 200 in 152ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 1003ms
 â—‹ Compiling /[locale]/analytics ...
 âœ“ Compiled /[locale]/analytics in 2.3s (2240 modules)
 GET /api/restaurants?active=true 200 in 2507ms
 GET /api/restaurants?active=true 200 in 457ms
 â¨¯ Error: No locale was returned from `getRequestConfig`.

See https://next-intl.dev/docs/usage/configuration#i18n-request
    at async AnalyticsPage (src/app/[locale]/analytics/page.tsx:45:12)
  43 | export default async function AnalyticsPage({ params }: AnalyticsPageProps) {
  44 |   const resolvedParams = await params;
> 45 |   const t = await getTranslations({ locale: resolvedParams.locale, namespace: 'analytics' });
     |            ^
  46 |   
  47 |   // Validate locale
  48 |   const validLocales = ['en', 'fr', 'th']; {
  digest: '2595071671'
}
 GET /en/analytics 500 in 3018ms
 âœ“ Compiled in 120ms (935 modules)
 GET /en/login?redirect=%2F 200 in 82ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 12ms
 GET /api/auth/location-session/check 200 in 1522ms
 GET /api/auth/location-session/check 200 in 109ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 1167ms
 GET /en/login?redirect=%2Fen%2Fanalytics%2Fexecutive 200 in 34ms
 GET /api/restaurants?active=true 200 in 41ms
 GET /en/login?redirect=%2F 200 in 29ms
 GET /api/auth/location-session/check 200 in 103ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 19ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 496ms
 GET /api/auth/location-session/check 200 in 388ms
 GET /api/restaurants?active=true 200 in 96ms
 GET /api/restaurants?active=true 200 in 79ms
 â—‹ Compiling /[locale]/analytics/operations ...
 âœ“ Compiled /[locale]/analytics/operations in 696ms (2268 modules)
 â¨¯ Error: No intl context found. Have you configured the provider? See https://next-intl.dev/docs/usage/configuration#server-client-components
    at useI18n (src/hooks/use-i18n.ts:23:26)
    at OperationalInsightsDashboard (src/components/analytics/operational-insights-dashboard.tsx:146:31)
  21 |  */
  22 | export function useI18n() {
> 23 |   const locale = useLocale() as Locale;
     |                          ^
  24 |   const t = useTranslations();
  25 |   const router = useRouter();
  26 |   const pathname = usePathname(); {
  digest: '3866913199'
}
 GET /en/analytics/operations 500 in 1398ms
 âœ“ Compiled in 128ms (947 modules)
 GET /en/login?redirect=%2F 200 in 58ms
 GET /api/auth/location-session/check 200 in 135ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 12ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 386ms
 GET /api/auth/location-session/check 200 in 74ms
 GET /api/restaurants?active=true 200 in 119ms
 GET /api/restaurants?active=true 200 in 107ms
 â—‹ Compiling /[locale]/analytics/sop ...
 âœ“ Compiled /[locale]/analytics/sop in 509ms (2300 modules)
 â¨¯ Error: No intl context found. Have you configured the provider? See https://next-intl.dev/docs/usage/configuration#server-client-components
    at useI18n (src/hooks/use-i18n.ts:23:26)
    at SOPAnalyticsDashboard (src/components/analytics/sop-analytics-dashboard.tsx:135:31)
  21 |  */
  22 | export function useI18n() {
> 23 |   const locale = useLocale() as Locale;
     |                          ^
  24 |   const t = useTranslations();
  25 |   const router = useRouter();
  26 |   const pathname = usePathname(); {
  digest: '638822012'
}
 GET /en/analytics/sop 500 in 1150ms
 âœ“ Compiled in 123ms (961 modules)
 GET /en/login?redirect=%2F 200 in 52ms
 GET /api/auth/location-session/check 200 in 141ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 12ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 409ms
 GET /api/auth/location-session/check 200 in 320ms
 GET /api/restaurants?active=true 200 in 143ms
 GET /api/restaurants?active=true 200 in 100ms
 âœ“ Compiled /[locale]/analytics/training in 479ms (2362 modules)
 â¨¯ Error: No intl context found. Have you configured the provider? See https://next-intl.dev/docs/usage/configuration#server-client-components
    at useI18n (src/hooks/use-i18n.ts:23:26)
    at TrainingAnalyticsDashboard (src/components/training/training-analytics-dashboard.tsx:140:31)
  21 |  */
  22 | export function useI18n() {
> 23 |   const locale = useLocale() as Locale;
     |                          ^
  24 |   const t = useTranslations();
  25 |   const router = useRouter();
  26 |   const pathname = usePathname(); {
  digest: '2540442601'
}
 GET /en/analytics/training 500 in 1109ms
 âœ“ Compiled in 126ms (990 modules)
 GET /en/login?redirect=%2F 200 in 52ms
 GET /api/auth/location-session/check 200 in 111ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 12ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 375ms
 GET /api/auth/location-session/check 200 in 103ms
 GET /api/restaurants?active=true 200 in 130ms
 GET /api/restaurants?active=true 200 in 101ms
 âœ“ Compiled /[locale]/analytics/monitoring in 421ms (2392 modules)
 â¨¯ Error: No intl context found. Have you configured the provider? See https://next-intl.dev/docs/usage/configuration#server-client-components
    at useI18n (src/hooks/use-i18n.ts:23:26)
    at RealtimeMonitoringDashboard (src/components/analytics/realtime-monitoring-dashboard.tsx:151:31)
  21 |  */
  22 | export function useI18n() {
> 23 |   const locale = useLocale() as Locale;
     |                          ^
  24 |   const t = useTranslations();
  25 |   const router = useRouter();
  26 |   const pathname = usePathname(); {
  digest: '1644093725'
}
 GET /en/analytics/monitoring 500 in 1040ms
 âœ“ Compiled in 131ms (1003 modules)
 GET /en/login?redirect=%2F 200 in 66ms
 GET /api/auth/location-session/check 200 in 361ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 9ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /api/auth/location-session/check 200 in 340ms
 POST /api/auth/login 200 in 618ms
 GET /api/restaurants?active=true 200 in 137ms
 GET /api/restaurants?active=true 200 in 74ms
 â¨¯ Error: No locale was returned from `getRequestConfig`.

See https://next-intl.dev/docs/usage/configuration#i18n-request
    at async AnalyticsPage (src/app/[locale]/analytics/page.tsx:45:12)
  43 | export default async function AnalyticsPage({ params }: AnalyticsPageProps) {
  44 |   const resolvedParams = await params;
> 45 |   const t = await getTranslations({ locale: resolvedParams.locale, namespace: 'analytics' });
     |            ^
  46 |   
  47 |   // Validate locale
  48 |   const validLocales = ['en', 'fr', 'th']; {
  digest: '2595071671'
}
 GET /en/analytics 500 in 70ms
 âœ“ Compiled in 146ms (1003 modules)
 GET /en/login?redirect=%2F 200 in 37ms
 GET /en/login?redirect=%2F 200 in 28ms
 GET /en/login?redirect=%2F 200 in 26ms
 GET /api/auth/location-session/check 200 in 101ms
 GET /en/login?redirect=%2F 200 in 39ms
 GET /api/auth/location-session/check 200 in 110ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 58ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 239ms
 GET /api/auth/location-session/check 200 in 111ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'manager@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: manager@krongthai.com
 POST /api/auth/login 200 in 58ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 342ms
 âœ“ Compiled in 1693ms (2669 modules)
âœ… Environment configuration validated for development
 GET /en/login?redirect=%2F 200 in 77ms
 GET /api/auth/location-session/check 200 in 210ms
 GET /api/auth/location-session/check 200 in 97ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'invalid@email.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: invalid@email.com
 POST /api/auth/login 200 in 68ms
[AUTH-DEBUG] Database query result: {
  hasUser: false,
  error: 'JSON object requested, multiple (or no) rows returned',
  errorCode: 'PGRST116'
}
[AUTH-ERROR] 2025-07-27T16:38:00.161Z: {
  "timestamp": "2025-07-27T16:38:00.161Z",
  "context": "DATABASE_QUERY",
  "error": {
    "code": "PGRST116",
    "details": "The result contains 0 rows",
    "hint": null,
    "message": "JSON object requested, multiple (or no) rows returned"
  },
  "metadata": {
    "operation": "auth_users_lookup",
    "email": "invalid@email.com",
    "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Cypress/14.5.3 Chrome/130.0.6723.137 Electron/33.2.1 Safari/537.36",
    "ip": "::ffff:127.0.0.1"
  }
}
 GET /en/login?redirect=%2F 200 in 149ms
 GET /api/auth/location-session/check 200 in 125ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'test@test.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: test@test.com
 POST /api/auth/login 200 in 63ms
[AUTH-DEBUG] Database query result: {
  hasUser: false,
  error: 'JSON object requested, multiple (or no) rows returned',
  errorCode: 'PGRST116'
}
[AUTH-ERROR] 2025-07-27T16:38:01.561Z: {
  "timestamp": "2025-07-27T16:38:01.561Z",
  "context": "DATABASE_QUERY",
  "error": {
    "code": "PGRST116",
    "details": "The result contains 0 rows",
    "hint": null,
    "message": "JSON object requested, multiple (or no) rows returned"
  },
  "metadata": {
    "operation": "auth_users_lookup",
    "email": "test@test.com",
    "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Cypress/14.5.3 Chrome/130.0.6723.137 Electron/33.2.1 Safari/537.36",
    "ip": "::ffff:127.0.0.1"
  }
}
 GET /en/login?redirect=%2F 200 in 42ms
 GET /api/auth/location-session/check 200 in 90ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 41ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 249ms
 GET /api/auth/location-session/check 200 in 115ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 75ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 77ms
 GET /api/auth/location-session/check 200 in 414ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 61ms
 GET /en/login?redirect=%2F 200 in 37ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /api/auth/location-session/check 200 in 277ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 57ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 33ms
 GET /api/auth/location-session/check 200 in 209ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 48ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 327ms
 GET /api/auth/location-session/check 200 in 176ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 53ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 324ms
 GET /api/auth/location-session/check 200 in 173ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 61ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 36ms
 GET /api/auth/location-session/check 200 in 115ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 53ms
 GET /en/login?redirect=%2F 200 in 42ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /api/auth/location-session/check 200 in 105ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 POST /api/auth/login 200 in 68ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 GET /en/login?redirect=%2F 200 in 78ms
 GET /api/auth/location-session/check 200 in 200ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 396ms
 GET /api/restaurants?active=true 200 in 101ms
 GET /api/restaurants?active=true 200 in 85ms
 âœ“ Compiled in 194ms (1003 modules)
 GET /en/login?redirect=%2F 200 in 38ms
 GET /api/auth/location-session/check 200 in 204ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 11ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 376ms
 GET /api/auth/login 405 in 17ms
 GET /api/auth/location-session/check 200 in 106ms
 GET /api/restaurants?active=true 200 in 171ms
 GET /api/restaurants 200 in 168ms
 GET /api/restaurants?active=true 200 in 66ms
 GET /api/auth/location-session/check 200 in 106ms
 GET /en/login?redirect=%2F 200 in 43ms
 GET /api/auth/location-session/check 200 in 136ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 19ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 398ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 33ms
 GET /api/restaurants?active=true 200 in 13ms
 GET /api/auth/location-session/check 200 in 347ms
 GET /api/auth/location-session/check 200 in 65ms
 GET /en/login?redirect=%2F 200 in 32ms
 GET /api/auth/location-session/check 200 in 86ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 16ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 372ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 41ms
 GET /api/restaurants?active=true 200 in 47ms
 GET /api/auth/location-session/check 200 in 60ms
 GET /api/auth/location-session/check 200 in 5ms
 GET /en/login?redirect=%2F 200 in 32ms
 GET /api/auth/location-session/check 200 in 79ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 374ms
 GET /en/login?redirect=%2Fth%2Flogin 200 in 311ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 35ms
 GET /api/restaurants?active=true 200 in 7ms
 GET /api/auth/location-session/check 200 in 7ms
 â¨¯ Error: No locale was returned from `getRequestConfig`.

See https://next-intl.dev/docs/usage/configuration#i18n-request
    at async AnalyticsPage (src/app/[locale]/analytics/page.tsx:45:12)
  43 | export default async function AnalyticsPage({ params }: AnalyticsPageProps) {
  44 |   const resolvedParams = await params;
> 45 |   const t = await getTranslations({ locale: resolvedParams.locale, namespace: 'analytics' });
     |            ^
  46 |   
  47 |   // Validate locale
  48 |   const validLocales = ['en', 'fr', 'th']; {
  digest: '2595071671'
}
 GET /en/analytics 500 in 75ms
 GET /api/auth/location-session/check 200 in 67ms
 âœ“ Compiled in 174ms (1003 modules)
 GET /en/login?redirect=%2F 200 in 36ms
 GET /api/auth/location-session/check 200 in 63ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 363ms
 GET /en/login?redirect=%2Fth%2Flogin 200 in 301ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 34ms
 GET /api/auth/location-session/check 200 in 8ms
 GET /api/restaurants?active=true 200 in 46ms
 â¨¯ Error: No locale was returned from `getRequestConfig`.

See https://next-intl.dev/docs/usage/configuration#i18n-request
    at async AnalyticsPage (src/app/[locale]/analytics/page.tsx:45:12)
  43 | export default async function AnalyticsPage({ params }: AnalyticsPageProps) {
  44 |   const resolvedParams = await params;
> 45 |   const t = await getTranslations({ locale: resolvedParams.locale, namespace: 'analytics' });
     |            ^
  46 |   
  47 |   // Validate locale
  48 |   const validLocales = ['en', 'fr', 'th']; {
  digest: '2595071671'
}
 GET /en/analytics 500 in 44ms
 GET /api/auth/location-session/check 200 in 69ms
 âœ“ Compiled in 152ms (1003 modules)
 GET /en/login?redirect=%2F 200 in 108ms
 GET /api/auth/location-session/check 200 in 76ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 18ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 378ms
 GET /en/login?redirect=%2Fen%2Fnonexistent-page 200 in 37ms
 GET /api/restaurants?active=true 200 in 44ms
 GET /api/auth/location-session/check 200 in 55ms
 GET /api/auth/location-session/check 200 in 76ms
 âœ“ Compiled /_not-found in 324ms (2369 modules)
 GET /en/invalid/route 404 in 452ms
 GET /en/login?redirect=%2F 200 in 97ms
 GET /api/auth/location-session/check 200 in 109ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 9ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 397ms
 GET /api/auth/location-session/check 200 in 308ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 38ms
 GET /api/restaurants?active=true 200 in 60ms
 â—‹ Compiling /[locale]/dashboard ...
 âœ“ Compiled /[locale]/dashboard in 1692ms (3194 modules)
 GET /api/auth/location-session/check 200 in 1814ms
 GET /fr/dashboard 200 in 2226ms
 GET /en/dashboard 200 in 55ms
 GET /en/login?redirect=%2F 200 in 73ms
 GET /api/auth/location-session/check 200 in 74ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 10ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 370ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 52ms
 GET /api/auth/location-session/check 200 in 66ms
 GET /api/restaurants?active=true 200 in 61ms
 GET /api/auth/location-session/check 200 in 6ms
 GET /en/login?redirect=%2F 200 in 32ms
 GET /api/auth/location-session/check 200 in 74ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 392ms
 GET /en/login?redirect=%2Fth%2Flogin 200 in 326ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 31ms
 GET /api/restaurants?active=true 200 in 7ms
 GET /api/auth/location-session/check 200 in 10ms
 GET /api/auth/location-session/check 200 in 5ms
 GET /en/login?redirect=%2F 200 in 34ms
 GET /api/auth/location-session/check 200 in 68ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 381ms
 GET /en/login?redirect=%2Fth%2Flogin 200 in 316ms
 GET /en/login?redirect=%2Fen%2Fdashboard 200 in 32ms
 GET /api/restaurants?active=true 200 in 6ms
 GET /api/auth/location-session/check 200 in 7ms
 GET /en/dashboard 200 in 26ms
 GET /api/auth/location-session/check 200 in 10ms
 GET /en/dashboard 200 in 34ms
 GET /en/login?redirect=%2F 200 in 33ms
 GET /api/auth/location-session/check 200 in 94ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 387ms
 GET /api/restaurants?active=true 200 in 65ms
 GET /api/restaurants?active=true 200 in 71ms
 âœ“ Compiled in 223ms (1416 modules)
 GET /en/login?redirect=%2F 200 in 44ms
 GET /api/auth/location-session/check 200 in 251ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 15ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 409ms
 GET /api/restaurants?active=true 200 in 72ms
 GET /api/auth/location-session/check 200 in 433ms
 GET /api/restaurants?active=true 200 in 79ms
 GET /en/dashboard 200 in 42ms
 GET /en/login?redirect=%2F 200 in 30ms
 GET /api/auth/location-session/check 200 in 78ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 373ms
 GET /en/login?redirect=%2Fth%2Flogin 200 in 309ms
 GET /api/auth/location-session/check 200 in 68ms
 GET /api/restaurants?active=true 200 in 123ms
 GET /api/restaurants?active=true 200 in 66ms
 GET /en/dashboard 200 in 38ms
 GET /en/__/fonts/FiraCode-VF.woff2 404 in 38ms
 âœ“ Compiled in 237ms (1416 modules)
 GET /en/login?redirect=%2F 200 in 157ms
 GET /api/auth/location-session/check 200 in 175ms
[AUTH-DEBUG] Environment check: {
  hasSupabaseUrl: true,
  hasServiceKey: true,
  hasAnonKey: true,
  nodeEnv: 'development',
  supabaseUrl: 'https://blimbcomhmhlubqngben.s...'
}
[AUTH-DEBUG] Login attempt: { email: 'admin@krongthai.com', pinLength: 4, locale: 'en' }
[AUTH-DEBUG] Supabase client created successfully
[AUTH-DEBUG] Querying auth_users for: admin@krongthai.com
 GET /en/login?redirect=%2Fth%2Flogin 200 in 15ms
[AUTH-DEBUG] Database query result: { hasUser: true, error: undefined, errorCode: undefined }
 POST /api/auth/login 200 in 397ms
 GET /api/auth/location-session/check 200 in 390ms
 GET /api/restaurants?active=true 200 in 108ms
 GET /api/restaurants?active=true 200 in 89ms
 GET /en/login 200 in 40ms
 GET /api/auth/location-session/check 200 in 6ms
 GET /en/login?redirect=%2F 200 in 29ms
 GET /api/auth/location-session/check 200 in 103ms
 âœ“ Compiled in 1543ms (2738 modules)
 âœ“ Compiled in 183ms (1412 modules)
 âœ“ Compiled in 525ms (1412 modules)
 âœ“ Compiled in 182ms (1412 modules)
 âœ“ Compiled in 180ms (1412 modules)
 âœ“ Compiled in 302ms (1412 modules)
 âœ“ Compiled in 533ms (1412 modules)
 âœ“ Compiled in 673ms (2738 modules)
 âœ“ Compiled in 353ms (1412 modules)
[?25h
